# encoding: utf-8
# language: ru

@UI @Analysis
Функционал: 03 - Анализ полномочий и формирование отчета

  Как пользователь
  Я хочу выполнять анализ полномочий и получать понятный отчет
  Чтобы быстро выявлять недостающие права

Контекст:
  Дано Я запускаю сценарий открытия TestClient или подключаю уже существующий
  И Я закрыл все окна клиентского приложения
  И В панели функций я выбираю "Анализ полномочий ролей"
  Тогда открылось окно "Анализ полномочий ролей"

Сценарий: TS-04 - Анализ полномочий, когда все права присутствуют
  Дано из выпадающего списка "Роль источник" я выбираю по строке "РольИсточник"
  И в таблице "РолиПриемники" я перехожу к строке:
    | Роль |
    | РольПриемник |
  И в таблице "РолиПриемники" я изменяю флаг "Отметка"
  Когда я нажимаю на кнопку "Анализировать"
  Тогда открылось окно "Результат анализа полномочий"
  И я перехожу к закладке "Результат анализа"
  # Проверяем, что в отчете нет информации по этой роли, так как все права покрываются
  И табличный документ "Результат" не содержит значения:
    | "*РольПриемник*" |
  # Проверяем итоговую статистику
  И табличный документ "Результат" содержит строки:
    | *Проанализировано ролей: 1* |
    | *Требуют доработки: 0* |
    | *Без замечаний: 1* |

Сценарий: TS-05 - Анализ полномочий при наличии недостающих прав
  Дано из выпадающего списка "Роль источник" я выбираю по строке "РольИсточник_ПолныеПрава"
  И в таблице "РолиПриемники" я перехожу к строке:
    | Роль |
    | РольПриемник_Чтение |
  И в таблице "РолиПриемники" я изменяю флаг "Отметка"
  Когда я нажимаю на кнопку "Анализировать"
  Тогда открылось окно "Результат анализа полномочий"
  И я перехожу к закладке "Результат анализа"
  # Проверяем, что в отчете есть информация о недостающих правах
  И табличный документ "Результат" содержит строки:
    | *РольПриемник_Чтение* |
    | *Справочник.Номенклатура* |
    | *Изменение, Удаление* |
    | *Документ.Заказ* |
    | *Добавление* |
  # Проверяем итоговую статистику
  И табличный документ "Результат" содержит строки:
    | *Проанализировано ролей: 1* |
    | *Требуют доработки: 1* |
    | *Без замечаний: 0* |

Сценарий: TS-06 - Анализ полномочий с учетом иерархии прав
  Дано из выпадающего списка "Роль источник" я выбираю по строке "РольИсточник_ЧтениеДобавление"
  И в таблице "РолиПриемники" я перехожу к строке:
    | Роль |
    | РольПриемник_Изменение |
  И в таблице "РолиПриемники" я изменяю флаг "Отметка"
  Когда я нажимаю на кнопку "Анализировать"
  Тогда открылось окно "Результат анализа полномочий"
  И я перехожу к закладке "Результат анализа"
  # Проверяем, что в отчете нет информации, так как право "Изменение" покрывает "Чтение" и "Добавление"
  И табличный документ "Результат" не содержит значения:
    | "*РольПриемник_Изменение*" |
  И табличный документ "Результат" содержит строки:
    | *Без замечаний: 1* |